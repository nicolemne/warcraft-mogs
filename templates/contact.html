{% extends "base.html" %}
{% load crispy_forms_tags static %}

{% block content %}

<div class="container">
    <div class="transparent-background">
        <div class="row g-0">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <h2 class="title-style">Contact Us</h2>

                <p class="font-style">We're eager to hear from <span
                        class="colour-emphasis"><strong>you!</strong></span> Share your ideas and suggestions by sending
                    us a message!
                </p>
                <form class="form-group" id="warcraftmogs-contact" onsubmit="return sendEmailWithFormData()">
                    {% csrf_token %}
                    {{ form | crispy }}
                    <button class="btn btn-dark btn-style btn-contact" type="submit">Send Message</button>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
function sendEmailWithFormData() {
    var form = document.getElementById("warcraftmogs-contact");
    var formData = new FormData(form);
    formData.set('service_id', 'service_77f87jt');
    formData.set('template_id', 'service_bezybmp');
    formData.set('user_id', 'WhFrtUwg0pjrz887N');

    $.ajax({
        url: 'https://api.emailjs.com/api/v1.0/email/send-form',
        type: 'POST',
        data: formData,
        processData: false,
        contentType: false,
        success: function(response) {
            alert('Your mail is sent!');
        },
        error: function(error) {
            alert('Oops... ' + JSON.stringify(error));
        }
    });

    return false; // Prevent form submission
}

</script>
{% endblock %}